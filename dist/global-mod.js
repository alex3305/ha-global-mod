(()=>{var r="global-mod",d="0.1.6";var c=class e{static instance;hass;config;styles;constructor(){e.instance=this,e.instance.styles=[],e.instance.refreshHomeAssistant(),e.instance.loadConfig(),e.instance.applyStyles(),e.instance.addEventListeners()}static get DarkMode(){return e.instance.hass.themes.darkMode}static get Name(){return r}static get Version(){return d}addEventListeners(){window.addEventListener("location-changed",()=>setTimeout(()=>e.instance.applyStyles()),!1),window.addEventListener("popstate",()=>e.instance.applyStyles(),!1),document.addEventListener("visibilitychange",()=>{document.hidden||e.instance.applyStyles()},!1),document.body.addEventListener("click",()=>e.instance.applyStyles(),!1),document.querySelector("hc-main")?.addEventListener("settheme",()=>{e.instance.refreshHomeAssistant(),e.instance.applyStyles()},!1),document.querySelector("home-assistant")?.addEventListener("settheme",()=>{e.instance.refreshHomeAssistant(),e.instance.applyStyles()},!1)}async addStyleElement(s,t){let a=document.createElement("style");return a.classList?.add(e.Name),a.setAttribute("type","text/css"),t.style&&(a.textContent+=t.style),(t["style-dark"]||t["style-light"])&&(a.textContent+=e.DarkMode?t["style-dark"]:t["style-light"]),s.appendChild(a),a}async applyStyles(){e.instance.styles.forEach(s=>s.classList?.remove("active"));for(let[s,t]of e.instance.config)if((!t||!t.path||!t.selector)&&console.error(`Rule ${t} has syntax errors...`),window.location.pathname.toLowerCase().includes(t.path.toLowerCase()))try{let o=await e.instance.selectTree(`home-assistant$${t.selector}`,1,9),n=await e.instance.addStyleElement(o,t);n?.classList?.add(s),n?.classList?.add("active"),e.instance.styles.push(n)}catch{console.error(`Could not add style element to ${t.selector}.`)}e.instance.styles.filter(s=>!s.classList?.contains("active")).forEach(s=>s.remove())}loadConfig(){let s=`${e.instance.hass.themes.theme}-${e.Name}`;e.instance.config=new Map;for(var t in e.instance.hass.themes.themes[s]){let a=t.substring(0,t.indexOf("-")),o=t.substring(t.indexOf("-")+1),n={};e.instance.config.has(a)&&(n=e.instance.config.get(a)),n[o]=e.instance.hass.themes.themes[s][t],e.instance.config.set(a,n)}!e.instance.config||e.instance.config.size==0?console.info(`%c Global mod %c loaded without any config... 
  \u{1F449} Add a 'mods' section to your theme %c ${s} %c to enable modding.`,"color:white;background:purple;","","color:black;background:lightblue;",""):console.info(`%c Global Mod %c ${e.Version} `,"color:white;background:purple;","color:white;background:darkgreen;")}refreshHomeAssistant(){e.instance.hass=document.querySelector("home-assistant").hass}async selectTree(s,t,a){let o=s.split("$"),n;try{for(let i=0;i<o.length;i++)o[i]&&(n=n?n.querySelector(o[i]):document.querySelector(o[i]),i+1<o.length&&(n=n.shadowRoot));if(!n)throw new Error;return n}catch{if(console.warn(`Retry for ${s}`),t===a)throw new Error(`No Element Found for ${s}`);return await new Promise(i=>setTimeout(i,t*25)),await e.instance.selectTree(s,t+1,a)}}};new c;})();
